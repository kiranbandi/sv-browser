// Third party vendor library for parsing SVG and adding inline css
export default function(a){for(var b=a.cloneNode(!0),c=b.ownerDocument||document,d=usedStyles(a,!0,!0),e=parentChain(a,d),f=["width","height","xmlns"],g=!1,h=function(a){a.appendChild(b),f.forEach(function(c){var d=b.getAttribute(c);null!=d&&a.setAttribute(c,b.getAttribute(c)),b.removeAttribute(c)}),b=a,g=!0},i=0;i<e.length;i++){var j=e[i],k=c.createElementNS("http://www.w3.org/2000/svg","svg"),l=!0;Object.keys(j).forEach(a=>{j[a]&&(k.setAttribute(a,j[a]),l=!1)}),l||h(k)}if(null!=a.parentNode&&!g){var k=c.createElementNS("http://www.w3.org/2000/svg","svg");h(k)}g&&b.setAttribute("style",window.getComputedStyle(a).cssText),b.setAttribute("version","1.1"),b.setAttribute("xmlns","http://www.w3.org/2000/svg"),b.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");var m=c.createElement("style");m.setAttribute("type","text/css");var n=c.createTextNode(d.join("\n"));m.appendChild(n),b.insertBefore(m,b.firstChild);var o=[];return b.querySelectorAll("image").forEach(function(a){o.push(new Promise(function(b){toDataURL(a.href.baseVal,function(c){a.href.baseVal=c,b()})}))}),new Promise(function(a){Promise.all(o).then(function(){a(b)})})};function parentChain(a,b){for(var c=a.ownerDocument||document,d=[];a.parentNode!==c&&null!==a.parentNode;)a=a.parentNode,d.push({id:a.id,class:a.getAttribute("class")||""});return d.forEach(function(a){var d={id:!1,class:!1},e=a.class.split(" ").filter(function(b){return 0<b.length});b.forEach(function(b){for(var f=0;f<e.length;f++)if(0<=b.indexOf("."+e[f])){d.class=!0;break}a.id&&0<=b.indexOf("#"+a.id)&&(d.id=!0)}),Object.keys(d).forEach(function(b){d[b]||(a[b]=void 0)})}),d}function usedStyles(a,b,c){for(var d,e=[],f=a.ownerDocument||document,g=f.styleSheets,h=0;h<g.length;h++){try{if(null==g[h].cssRules)continue}catch(a){continue}for(var k=0;k<g[h].cssRules.length;k++){d=g[h].cssRules[k];var l=!1;try{b&&(l=0<a.querySelectorAll(d.selectorText).length),(!b||c)&&(l|=a.matches(d.selectorText))}catch(a){console.warn("CSS selector error: "+d.selectorText+". Often angular issue.",a)}l&&e.push(d.cssText)}}return e}function toDataURL(a,b){console.log("CONVERT...");var c=new XMLHttpRequest;c.open("get",a),c.responseType="blob",c.onload=function(){var a=new FileReader;a.onload=function(){b(this.result)},a.readAsDataURL(c.response)},c.send()}